<?xml version="1.0" encoding="UTF-8"?>
<con:testCase failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Authenticate TestCase" searchProperties="true" id="1394625d-c32e-48f5-82d4-f114817c612d" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="1394625d-c32e-48f5-82d4-f114817c612dfileName">Authenticate-TestCase</con:setting></con:settings><con:testStep type="datasource" name="DataSource" id="c11dc8f0-a37f-47c2-ab44-3370fa6f87a9"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>../../Mercedez ME/AUDI_CWP_US_REST.xlsx</file><worksheet>AUDI_CWP_US</worksheet><cell>A2</cell><ignoreEmpty>true</ignoreEmpty></con:configuration></con:dataSource><con:property>TestCases</con:property><con:property>Authenticate_EndPoint_Address_REST</con:property><con:property>Authenticate_EndPoint_TraceTimestamp</con:property><con:property>Authenticate_EndPoint_Address_SOAP</con:property><con:property>EndPoint_Address_SOAP</con:property><con:property>Authenticate_Soap_Action</con:property><con:property>Soap_Action</con:property><con:property>Authenticate_Username</con:property><con:property>Authenticate_Password</con:property><con:property>Authenticate_Type</con:property><con:property>Authenticate_ExternalUserName</con:property><con:property>Authenticate_ExternalUserID</con:property><con:property>Authenticate_Email</con:property><con:property>Authenticate_TraceID</con:property><con:property>Authenticate_Version</con:property><con:property>Autenticate_Source_Name</con:property><con:property>Autenticate_Source_Name_Web</con:property><con:property>Fault_Description</con:property><con:property>Missing_Username</con:property><con:property>Missing_Password</con:property><con:property>Invalid_Username_AND_OR_Password</con:property><con:property>Api_Key</con:property><con:property>Phone</con:property><con:property>Response_Code</con:property><con:property>Response_Status</con:property><con:property>Response_Description</con:property><con:property>CertificatePath</con:property><con:property>AndriodCertificatePath</con:property><con:property>IphoneCertificatePath</con:property><con:property>Andriod_api_key</con:property><con:property>iPhone_api_key</con:property><con:property>SourceName</con:property><con:property>TransactionId</con:property><con:property>TransactionId_SOAP</con:property><con:property>Timestamp</con:property><con:property>Organization</con:property><con:property>Region</con:property><con:property>ApplicationName</con:property><con:property>AccountId</con:property><con:property>TCUID</con:property><con:property>VIN</con:property><con:property>UserId</con:property><con:property>EventTransId</con:property><con:property>EventTransId_SOAP</con:property><con:property>requestType</con:property><con:property>MissingApiKeyErrorCode</con:property><con:property>MissingTokenErrorCode</con:property><con:property>MissingCertificateErrorCode</con:property><con:property>InvalidApiKeyErrorCode</con:property><con:property>InvalidOrganizationErrorCode</con:property><con:property>InvalidRegionErrorCode</con:property><con:property>AccountAndVinMismatchErrorCode</con:property><con:property>AccountAndTcuidMismatchErrorCode</con:property><con:property>InvalidTokenErrorCode</con:property><con:property>EndPoint_Address</con:property><con:property>Invalid_Token_Android</con:property><con:property>Invalid_Token_Web</con:property><con:property>Invalid_Token_iPhone</con:property><con:property>Invalid_api_key</con:property><con:property>InvalidOrganization</con:property><con:property>InvalidRegion</con:property><con:property>Operation_Type</con:property><con:property>Request_ApplicationName</con:property><con:property>applicationSystem</con:property><con:property>Application_Name</con:property><con:property>startTime</con:property><con:property>endTime</con:property><con:property>charge</con:property><con:property>climate</con:property><con:property>windowHeating</con:property><con:property>nightTariffFlag</con:property><con:property>chargeMaxCurrent</con:property><con:property>profileID</con:property><con:property>profileName</con:property><con:property>profileName_SOAP</con:property><con:property>targetChargeLevel</con:property><con:property>ProfileOperation</con:property><con:property>Invalid_Account_ID</con:property><con:property>Invalid_VIN</con:property><con:property>Invalid_TCUID</con:property><con:property>timeroperation</con:property><con:property>timerexpiredstatus</con:property><con:property>timerprogrammedstatus</con:property><con:property>timerid</con:property><con:property>timertype</con:property><con:property>singletimerdeparturetime</con:property><con:property>singletimerstarttime</con:property><con:property>singletimertimezone</con:property><con:property>cyclictimerweekdaybitmask</con:property><con:property>cyclictimerstarttime</con:property><con:property>cyclictimertimezone</con:property><con:property>departuretimer_profileid</con:property><con:property>GeofenceCommand</con:property><con:property>AliasName</con:property><con:property>FenceId</con:property><con:property>rowId</con:property><con:property>AlertType</con:property><con:property>numberOfDays</con:property><con:property>popupFlag</con:property><con:property>ArmStatus</con:property><con:property>GeofenceType</con:property><con:property>BoundaryType</con:property><con:property>RearmType</con:property><con:property>IgnitionTrigger</con:property><con:property>VerticesPosition_latitude</con:property><con:property>VerticesPosition_longitude</con:property><con:property>CircleCenter_latitude</con:property><con:property>CircleCenter_longitude</con:property><con:property>Radius1</con:property><con:property>ellipseCenter_latitude</con:property><con:property>ellipseCenter_longitude</con:property><con:property>firstEllipseRadius</con:property><con:property>POIName</con:property><con:property>secondEllipseRadius</con:property><con:property>latitude1</con:property><con:property>longitude1</con:property><con:property>rectangleWidth</con:property><con:property>rectangleHeight</con:property><con:property>rotationAngle</con:property><con:property>scheduledStartTime</con:property><con:property>scheduledEndTime</con:property><con:property>ScheduleType1</con:property><con:property>DayInterval1</con:property><con:property>DayOfWeek1</con:property><con:property>MinutesFromMidnight1</con:property><con:property>Duration1</con:property><con:property>WeekInterval</con:property><con:property>DayOfMonth</con:property><con:property>monthInterval</con:property><con:property>SuspendUntilDate</con:property><con:property>alertByEmail</con:property><con:property>Data_emailOrSmsTn</con:property><con:property>enable</con:property><con:property>alertBySms</con:property><con:property>name</con:property><con:property>maximumSpeed</con:property><con:property>emailOrSmsTn</con:property><con:property>enabled</con:property><con:property>dbRowId</con:property><con:property>deleted</con:property><con:property>status</con:property><con:property>WebSite1</con:property><con:property>Operation</con:property><con:property>alertrequesttype</con:property><con:property>triptype</con:property><con:property>statsid</con:property><con:property>Authenticate_ResponseCode</con:property><con:property>Authenticate_ResponseStatus</con:property><con:property>Authenticate_ResponseDescription</con:property><con:property>tcuType</con:property><con:property>doorTypeParam</con:property><con:property>mode</con:property><con:property>timeToUnlock</con:property><con:property>courtesyCallFlag</con:property><con:property>System</con:property><con:property>DateFrom</con:property><con:property>DateTo</con:property><con:property>serviceOperationCode1</con:property><con:property>OEM</con:property><con:property>startRecordNo_SOAP</con:property><con:property>startRecordNo</con:property><con:property>maxNoOfRecords</con:property><con:property>emailid</con:property><con:property>Longitude</con:property><con:property>Latitude</con:property><con:property>flashTime</con:property><con:property>serviceDuration</con:property><con:property>serviceOperationCode</con:property><con:property>StreetNumber</con:property><con:property>StreetName</con:property><con:property>address1</con:property><con:property>address2</con:property><con:property>district</con:property><con:property>City</con:property><con:property>State</con:property><con:property>County</con:property><con:property>ZipCode</con:property><con:property>Country</con:property><con:property>addresstype</con:property><con:property>primaryaddressflag</con:property><con:property>PhoneNumber</con:property><con:property>POIType</con:property><con:property>immediateDestination</con:property><con:property>vipCategory</con:property><con:property>poiDBRowId</con:property><con:property>ExternalPoiID</con:property><con:property>WebSite</con:property><con:property>SortColumn</con:property><con:property>SortOrder</con:property><con:property>statusIndicator</con:property><con:property>speedId</con:property><con:property>ScheduleType</con:property><con:property>DayInterval</con:property><con:property>DayOfWeek</con:property><con:property>MinutesFromMidnight</con:property><con:property>Duration</con:property><con:property>popupFlag1</con:property><con:property>Market</con:property><con:property>UILanguage</con:property><con:property>SearchTerm</con:property><con:property>Radius</con:property><con:property>SearchOption</con:property><con:property>Offset</con:property><con:property>SortBy</con:property><con:property>SearchAddressParameter</con:property><con:property>minBatteryChargingPct</con:property><con:property>newpin</con:property><con:property>oldpin</con:property><con:property>type</con:property><con:property>service_name</con:property><con:property>service_name_SOAP</con:property><con:property>GeofenceNotificationPrefernece</con:property><con:property>PinUpdate_accountNumber</con:property><con:property>Email</con:property><con:property>climatisationDuration</con:property><con:property>climatisationFollowupTime</con:property><con:property>climatisationFollowupTimeBattery</con:property><con:property>climatisationWithoutHVPower</con:property><con:property>windowHeatingFront</con:property><con:property>windowHeatingRear</con:property><con:property>measurementState</con:property><con:property>measurementValue</con:property><con:property>TraceID</con:property><con:property>CommunicationToken</con:property><con:property>App_applicationName</con:property><con:startRow>2</con:startRow><con:endRow>2</con:endRow><con:trimValues>false</con:trimValues><con:entitizeValues>false</con:entitizeValues><con:restartOnRun>true</con:restartOnRun><con:expandProperties>false</con:expandProperties></con:config></con:testStep><con:testStep type="jdbc" name="JDBC Request" id="0c0b9664-524e-47bd-9bc8-fbc3a95ff0e7" disabled="true"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName xsi:nil="true"/><con:properties/></con:config></con:testStep><con:testStep type="request" name="Authenticate" id="818c70ab-7fde-42b6-b37d-6c094d9b5902"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AuthorizationServiceAUDIUSV5_2PortBinding</con:interface><con:operation>Authenticate</con:operation><con:request name="Authenticate" id="895559fc-6da8-4e67-a7d7-5ba3ac1d5475" defaultOutgoingWss="" defaultIncomingWss=""><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://${#Project#ServiceEndPoint}/SOAP/AUDIUS_AuthorizationServiceV5_2</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:aud="http://xmlns.vzt.com/APIGateway/AUDIUS_AuthorizationServiceV5_2">
<soapenv:Header> 
 <api_key>${#Project#api_key}</api_key> 
  <wsse:Security soapenv:mustUnderstand="1" wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"> 
   <wsse:UsernameToken> 
     <wsse:Username>${#Project#AccountId}</wsse:Username> 
     <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">8989</wsse:Password> 
   </wsse:UsernameToken> 
  </wsse:Security> 
</soapenv:Header>
  <soapenv:Body>
      <aud:Authenticate>
         <AuthenticateRequestType>
            <Data>
               <SourceName>WEB</SourceName>
               <ExternalUserName>${DataSource#Authenticate_ExternalUserName}</ExternalUserName>
               <ExternalUserID>${DataSource#Authenticate_ExternalUserID}</ExternalUserID>                                      
               <Email>john.smith@gmail.com</Email>
               <TraceID>Vishnu252622</TraceID>
               <TraceTimestamp>2015-03-04T22:14:02.001Z</TraceTimestamp>
            </Data>
         </AuthenticateRequestType>
      </aud:Authenticate>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="XPath Match" id="0e6d7274-3d35-4c75-9adc-a44ef98766c4" name="XPath Match"><con:configuration/></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:environmentSpec><con:entry environmentId="b56e681a-c44d-4881-95c6-fd3e3223d2a2"><con:authProfile>No Authorization</con:authProfile></con:entry></con:environmentSpec><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig action="Authenticate" mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer" id="8564afb1-1f44-4ec7-a3e0-035188cb693c" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="false" transferTextContent="false" failOnError="false" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="true" disabled="false"><con:name>SessionToken</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>Authenticate</con:sourceStep><con:sourcePath>declare namespace wsse='http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd';
//wsse:Security[1]</con:sourcePath><con:targetType>SessionToken</con:targetType><con:targetStep>#Project#</con:targetStep><con:targetPath/><con:targetTransferType>XPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="ef6a2d92-af5b-42e3-ae78-a4a54ec5ef8d"><con:settings/><con:config><script>def responsecontent=new String(testRunner.testCase.testSteps["Authenticate"].testRequest.response.rawResponseData)
def string = responsecontent
int startPosition = string.indexOf("&lt;soapenv:Header>") + "&lt;soapenv:Header>".length();
//log.info startPosition
int endPosition = string.indexOf("&lt;/soapenv:Header>",startPosition);
//log.info endPosition
String subS = string.substring(startPosition,endPosition );
log.info subS
testRunner.testCase.testSuite.project.setPropertyValue("SessionToken",subS)
</script></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>8564afb1-1f44-4ec7-a3e0-035188cb693c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase>